{
  # Keep local HTTPS, but don't bind to :80 for HTTP->HTTPS redirects.
  auto_https disable_redirects
}

https://localhost:8080 {
  # Serve the repo root so `/web/` and `/wasm/` both work.
  root * .

  file_server

  # Needed for `SharedArrayBuffer` (crossOriginIsolated).
  header {
    Cross-Origin-Opener-Policy "same-origin"
    Cross-Origin-Embedder-Policy "require-corp"
    Cross-Origin-Resource-Policy "same-origin"
    Origin-Agent-Cluster "?1"
  }

  # Make HTTPS explicit for localhost.
  tls internal
}

